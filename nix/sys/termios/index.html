<!DOCTYPE html><html lang="en" data-bs-color-scheme="light"><head><title>termios in nix::sys - Rust</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="color-scheme" content="light dark"><link href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-blackbox.min.css" integrity="sha384-nXtYGwAUBOgb4M8Eo9xOK3Er3bVPQo1HguUNWf/RheIagsbCaP3ZaYqVeUqHEr20" rel="stylesheet" crossorigin="anonymous"><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" integrity="sha384-tKLJeE1ALTUwtXlaGjJYM3sejfssWdAaWR2s97axw4xkiAdMzQjtOjgcyw0Y50KU" rel="stylesheet" crossorigin="anonymous"><link href="../../../style.css" rel="stylesheet"><link href="../../../rust.svg" rel="icon" type="image/svg+xml"></head><body><header class="navbar navbar-expand-md navbar-dark rd-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-2" href="../../../nix/index.html" aria-label="Rust"><img src="../../../rust.svg" width="40" height="40" alt="Rust Logo"></a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#rdNavbar" aria-controls="rdNavbar" aria-expanded="false" aria-label="Toggle navigation"><i class="bi bi-list"></i></button><div class="collapse navbar-collapse" id="rdNavbar"><ul class="navbar-nav flex-row flex-wrap pt-2 py-md-0"><li class="nav-item col-6 col-md-auto"><a class="nav-link p-2 active" href="../../../nix/index.html">nix</a></li></ul><hr class="d-md-none text-white-50"><ul class="navbar-nav flex-row flex-wrap ms-md-auto"><li class="nav-item col-6 col-md-auto"><a class="nav-link p-2" href="#themes" title="Toggle themes" onclick="darkmode.toggleDarkMode()"><i class="bi bi-palette"></i><small class="d-md-none ms-2">Themes</small></a></li><li class="nav-item col-6 col-md-auto" title="Unimplemented"><a class="nav-link p-2" href="#shortcuts"><i class="bi bi-question-lg"></i><small class="d-md-none ms-2">Shortcut</small></a></li><li class="nav-item col-6 col-md-auto" title="Unimplemented"><a class="nav-link p-2" href="#options"><i class="bi bi-wrench"></i><small class="d-md-none ms-2">Options</small></a></li></ul></div></nav></header><nav class="rd-subnavbar py-2 border-bottom shadow-sm" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="rd-search position-relative" id="rd-search-form"><span class="w-100" style="position: relative; display: inline-block; direction: ltr;"><input type="search" class="form-control ds-input" id="rd-search-input" placeholder="Search in nix..." aria-label="Search docs for..." autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="rd-search-menu" style="position: relative; vertical-align: top;" dir="auto"><span class="ds-dropdown-menu" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: 0px;" role="listbox" id="rd-search-menu"><div class="rd-search-items" id="rd-search-items"></div></span></span></form><button class="btn rd-sidebar-toggle d-md-none py-0 px-1 ms-3 order-3 collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#rd-docs-nav" aria-controls="rd-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation"><i class="bi bi-arrows-expand"></i><i class="bi bi-arrows-collapse"></i></button></div></nav><div id="main" class="container-xxl"><div class="rd-main"><div class="rd-intro"><h1 id="item-title" class="rd-anchor item-title">Module <a class="mod" href="../../index.html">nix</a>::<wbr><a class="mod" href="../index.html">sys</a>::<wbr><a class="mod" href="index.html">termios</a></h1><details id="item-documentation" class="rd-anchor item-documentation" open=""><summary>Documentation</summary><div class="mt-2"><p>An interface for controlling asynchronous communication ports</p>
<p>This interface provides a safe wrapper around the termios subsystem defined by POSIX. The
underlying types are all implemented in libc for most platforms and either wrapped in safer
types here or exported directly.</p>
<p>If you are unfamiliar with the <code>termios</code> API, you should first read the
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/basedefs/termios.h.html">API documentation</a> and
then come back to understand how <code>nix</code> safely wraps it.</p>
<p>It should be noted that this API incurs some runtime overhead above the base <code>libc</code> definitions.
As this interface is not used with high-bandwidth information, this should be fine in most
cases. The primary cost when using this API is that the <code>Termios</code> datatype here duplicates the
standard fields of the underlying <code>termios</code> struct and uses safe type wrappers for those fields.
This means that when crossing the FFI interface to the underlying C library, data is first
copied into the underlying <code>termios</code> struct, then the operation is done, and the data is copied
back (with additional sanity checking) into the safe wrapper types. The <code>termios</code> struct is
relatively small across all platforms (on the order of 32-64 bytes).</p>
<p>The following examples highlight some of the API use cases such that users coming from using C
or reading the standard documentation will understand how to use the safe API exposed here.</p>
<p>Example disabling processing of the end-of-file control character:</p>
<pre><code class="language-rust">termios.control_chars[VEOF as usize] = _POSIX_VDISABLE;</code></pre>
<p>The flags within <code>Termios</code> are defined as bitfields using the <code>bitflags</code> crate. This provides
an interface for working with bitfields that is similar to working with the raw unsigned
integer types but offers type safety because of the internal checking that values will always
be a valid combination of the defined flags.</p>
<p>An example showing some of the basic operations for interacting with the control flags:</p>
<pre><code class="language-rust">termios.control_flags &amp; ControlFlags::CSIZE == ControlFlags::CS5;
termios.control_flags |= ControlFlags::CS5;</code></pre><h2 class="rd-anchor" id="baud-rates">Baud rates<a aria-label="anchor" href="#baud-rates"><i class="bi bi-hash"></i></a></h2>
<p>This API is not consistent across platforms when it comes to <code>BaudRate</code>: Android and Linux both
only support the rates specified by the <code>BaudRate</code> enum through their termios API while the BSDs
support arbitrary baud rates as the values of the <code>BaudRate</code> enum constants are the same integer
value of the constant (<code>B9600</code> == <code>9600</code>). Therefore the <code>nix::termios</code> API uses the following
conventions:</p>
<ul>
<li><code>cfgetispeed()</code> - Returns <code>u32</code> on BSDs, <code>BaudRate</code> on Android/Linux</li>
<li><code>cfgetospeed()</code> - Returns <code>u32</code> on BSDs, <code>BaudRate</code> on Android/Linux</li>
<li><code>cfsetispeed()</code> - Takes <code>u32</code> or <code>BaudRate</code> on BSDs, <code>BaudRate</code> on Android/Linux</li>
<li><code>cfsetospeed()</code> - Takes <code>u32</code> or <code>BaudRate</code> on BSDs, <code>BaudRate</code> on Android/Linux</li>
<li><code>cfsetspeed()</code> - Takes <code>u32</code> or <code>BaudRate</code> on BSDs, <code>BaudRate</code> on Android/Linux</li>
</ul>
<p>The most common use case of specifying a baud rate using the enum will work the same across
platforms:</p>
<pre><code class="language-rust">cfsetispeed(&amp;mut t, BaudRate::B9600);
cfsetospeed(&amp;mut t, BaudRate::B9600);
cfsetspeed(&amp;mut t, BaudRate::B9600);</code></pre>
<p>Additionally round-tripping baud rates is consistent across platforms:</p>
<pre><code class="language-rust">let speed = cfgetispeed(&amp;t);
assert_eq!(speed, cfgetospeed(&amp;t));
cfsetispeed(&amp;mut t, speed);</code></pre>
<p>On non-BSDs, <code>cfgetispeed()</code> and <code>cfgetospeed()</code> both return a <code>BaudRate</code>:</p>
<pre><code class="language-rust">assert_eq!(cfgetispeed(&amp;t), BaudRate::B9600);
assert_eq!(cfgetospeed(&amp;t), BaudRate::B9600);</code></pre>
<p>But on the BSDs, <code>cfgetispeed()</code> and <code>cfgetospeed()</code> both return <code>u32</code>s:</p>
<pre><code class="language-rust">assert_eq!(cfgetispeed(&amp;t), 9600u32);
assert_eq!(cfgetospeed(&amp;t), 9600u32);</code></pre>
<p>It’s trivial to convert from a <code>BaudRate</code> to a <code>u32</code> on BSDs:</p>
<pre><code class="language-rust">assert_eq!(cfgetispeed(&amp;t), BaudRate::B9600.into());
assert_eq!(u32::from(BaudRate::B9600), 9600u32);</code></pre>
<p>And on BSDs you can specify arbitrary baud rates (<strong>note</strong> this depends on hardware support)
by specifying baud rates directly using <code>u32</code>s:</p>
<pre><code class="language-rust">cfsetispeed(&amp;mut t, 9600u32);
cfsetospeed(&amp;mut t, 9600u32);
cfsetspeed(&amp;mut t, 9600u32);</code></pre></div></details></div><div id="rd-docs-nav" class="rd-toc ps-xl-3 collapse"><strong class="d-block h6 my-2 pb-2 border-bottom">On this page</strong><nav id="TableOfContents"><ul><li><a href="#item-title" class="d-inline-flex align-items-center rounded"><strong>termios</strong></a></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#item-documentation" data-bs-toggle="collapse" data-bs-target="#toc-documentation" aria-expanded="true" aria-current="true"><strong>Documentation</strong></a><ul id="toc-documentation" class="collapse show"></ul></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#structs" data-bs-toggle="collapse" data-bs-target="#toc-structs" aria-expanded="true" aria-current="true"><strong>Structs</strong></a><ul id="toc-structs" class="collapse show"><li><a href="struct.ControlFlags.html" class="d-inline-block align-items-center rounded">ControlFlags</a></li><li><a href="struct.InputFlags.html" class="d-inline-block align-items-center rounded">InputFlags</a></li><li><a href="struct.LocalFlags.html" class="d-inline-block align-items-center rounded">LocalFlags</a></li><li><a href="struct.OutputFlags.html" class="d-inline-block align-items-center rounded">OutputFlags</a></li><li><a href="struct.Termios.html" class="d-inline-block align-items-center rounded">Termios</a></li></ul></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#enums" data-bs-toggle="collapse" data-bs-target="#toc-enums" aria-expanded="true" aria-current="true"><strong>Enums</strong></a><ul id="toc-enums" class="collapse show"><li><a href="enum.BaudRate.html" class="d-inline-block align-items-center rounded">BaudRate</a></li><li><a href="enum.FlowArg.html" class="d-inline-block align-items-center rounded">FlowArg</a></li><li><a href="enum.FlushArg.html" class="d-inline-block align-items-center rounded">FlushArg</a></li><li><a href="enum.SetArg.html" class="d-inline-block align-items-center rounded">SetArg</a></li><li><a href="enum.SpecialCharacterIndices.html" class="d-inline-block align-items-center rounded">SpecialCharacterIndices</a></li></ul></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#functions" data-bs-toggle="collapse" data-bs-target="#toc-functions" aria-expanded="true" aria-current="true"><strong>Functions</strong></a><ul id="toc-functions" class="collapse show"><li><a href="fn.cfgetispeed.html" class="d-inline-block align-items-center rounded">cfgetispeed</a></li><li><a href="fn.cfgetospeed.html" class="d-inline-block align-items-center rounded">cfgetospeed</a></li><li><a href="fn.cfmakeraw.html" class="d-inline-block align-items-center rounded">cfmakeraw</a></li><li><a href="fn.cfsetispeed.html" class="d-inline-block align-items-center rounded">cfsetispeed</a></li><li><a href="fn.cfsetospeed.html" class="d-inline-block align-items-center rounded">cfsetospeed</a></li><li><a href="fn.cfsetspeed.html" class="d-inline-block align-items-center rounded">cfsetspeed</a></li><li><a href="fn.tcdrain.html" class="d-inline-block align-items-center rounded">tcdrain</a></li><li><a href="fn.tcflow.html" class="d-inline-block align-items-center rounded">tcflow</a></li><li><a href="fn.tcflush.html" class="d-inline-block align-items-center rounded">tcflush</a></li><li><a href="fn.tcgetattr.html" class="d-inline-block align-items-center rounded">tcgetattr</a></li><li><a href="fn.tcgetsid.html" class="d-inline-block align-items-center rounded">tcgetsid</a></li><li><a href="fn.tcsendbreak.html" class="d-inline-block align-items-center rounded">tcsendbreak</a></li><li><a href="fn.tcsetattr.html" class="d-inline-block align-items-center rounded">tcsetattr</a></li></ul></li></ul></nav></div><div class="rd-content"><section><h2 id="structs" class="rd-anchor">Structs<a aria-label="anchor" href="#structs"><i class="bi bi-hash"></i></a></h2><div class="item-table"><div><p><a href="struct.ControlFlags.html" class="struct">ControlFlags</a></p></div><div><p>Flags for setting the control mode of a terminal</p>
</div><div><p><a href="struct.InputFlags.html" class="struct">InputFlags</a></p></div><div><p>Flags for configuring the input mode of a terminal</p>
</div><div><p><a href="struct.LocalFlags.html" class="struct">LocalFlags</a></p></div><div><p>Flags for setting any local modes</p>
</div><div><p><a href="struct.OutputFlags.html" class="struct">OutputFlags</a></p></div><div><p>Flags for configuring the output mode of a terminal</p>
</div><div><p><a href="struct.Termios.html" class="struct">Termios</a></p></div><div><p>Stores settings for the termios API</p>
</div></div></section><section><h2 id="enums" class="rd-anchor">Enums<a aria-label="anchor" href="#enums"><i class="bi bi-hash"></i></a></h2><div class="item-table"><div><p><a href="enum.BaudRate.html" class="enum">BaudRate</a></p></div><div><p>Baud rates supported by the system.</p>
</div><div><p><a href="enum.FlowArg.html" class="enum">FlowArg</a></p></div><div><p>Specify how transmission flow should be altered</p>
</div><div><p><a href="enum.FlushArg.html" class="enum">FlushArg</a></p></div><div><p>Specify a combination of the input and output buffers to flush</p>
</div><div><p><a href="enum.SetArg.html" class="enum">SetArg</a></p></div><div><p>Specify when a port configuration change should occur.</p>
</div><div><p><a href="enum.SpecialCharacterIndices.html" class="enum">SpecialCharacterIndices</a></p></div><div><p>Indices into the <code>termios.c_cc</code> array for special characters.</p>
</div></div></section><section><h2 id="functions" class="rd-anchor">Functions<a aria-label="anchor" href="#functions"><i class="bi bi-hash"></i></a></h2><div class="item-table"><div><p><a href="fn.cfgetispeed.html" class="fn">cfgetispeed</a></p></div><div><p>Get input baud rate (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/cfgetispeed.html">cfgetispeed(3p)</a>).</p>
</div><div><p><a href="fn.cfgetospeed.html" class="fn">cfgetospeed</a></p></div><div><p>Get output baud rate (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/cfgetospeed.html">cfgetospeed(3p)</a>).</p>
</div><div><p><a href="fn.cfmakeraw.html" class="fn">cfmakeraw</a></p></div><div><p>Configures the port to something like the “raw” mode of the old Version 7 terminal driver (see
<a href="https://man7.org/linux/man-pages/man3/termios.3.html">termios(3)</a>).</p>
</div><div><p><a href="fn.cfsetispeed.html" class="fn">cfsetispeed</a></p></div><div><p>Set input baud rate (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/cfsetispeed.html">cfsetispeed(3p)</a>).</p>
</div><div><p><a href="fn.cfsetospeed.html" class="fn">cfsetospeed</a></p></div><div><p>Set output baud rate (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/cfsetospeed.html">cfsetospeed(3p)</a>).</p>
</div><div><p><a href="fn.cfsetspeed.html" class="fn">cfsetspeed</a></p></div><div><p>Set both the input and output baud rates (see
<a href="https://www.freebsd.org/cgi/man.cgi?query=cfsetspeed">termios(3)</a>).</p>
</div><div><p><a href="fn.tcdrain.html" class="fn">tcdrain</a></p></div><div><p>Block until all output data is written (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcdrain.html">tcdrain(3p)</a>).</p>
</div><div><p><a href="fn.tcflow.html" class="fn">tcflow</a></p></div><div><p>Suspend or resume the transmission or reception of data (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcflow.html">tcflow(3p)</a>).</p>
</div><div><p><a href="fn.tcflush.html" class="fn">tcflush</a></p></div><div><p>Discard data in the output or input queue (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcflush.html">tcflush(3p)</a>).</p>
</div><div><p><a href="fn.tcgetattr.html" class="fn">tcgetattr</a></p></div><div><p>Return the configuration of a port
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcgetattr.html">tcgetattr(3p)</a>).</p>
</div><div><p><a href="fn.tcgetsid.html" class="fn">tcgetsid</a></p></div><div><p>Get the session controlled by the given terminal (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcgetsid.html">tcgetsid(3)</a>).</p>
</div><div><p><a href="fn.tcsendbreak.html" class="fn">tcsendbreak</a></p></div><div><p>Send a break for a specific duration (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcsendbreak.html">tcsendbreak(3p)</a>).</p>
</div><div><p><a href="fn.tcsetattr.html" class="fn">tcsetattr</a></p></div><div><p>Set the configuration for a terminal (see
<a href="https://pubs.opengroup.org/onlinepubs/9699919799/functions/tcsetattr.html">tcsetattr(3p)</a>).</p>
</div></div></section></div></div></div><footer class="container-xxl text-center">The rd developpers - (c) 2022</footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js" integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFf19TOAs2zVinnD/C7E91j9yyk5//jjpt/" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/js/darkmode.min.js" integrity="sha384-A4SLs39X/aUfwRclRaXvNeXNBTLZdnZdHhhteqbYFS2jZTRD79tKeFeBn7SGXNpi" crossorigin="anonymous"></script><script src="../../../nix/search-index.js"></script><script src="../../../search.js"></script></body></html>
