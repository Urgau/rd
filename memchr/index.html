<!DOCTYPE html><html lang="en" data-bs-color-scheme="light"><head><title>memchr - Rust</title><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="color-scheme" content="light dark"><link href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-blackbox.min.css" integrity="sha384-nXtYGwAUBOgb4M8Eo9xOK3Er3bVPQo1HguUNWf/RheIagsbCaP3ZaYqVeUqHEr20" rel="stylesheet" crossorigin="anonymous"><link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" integrity="sha384-tKLJeE1ALTUwtXlaGjJYM3sejfssWdAaWR2s97axw4xkiAdMzQjtOjgcyw0Y50KU" rel="stylesheet" crossorigin="anonymous"><link href="../style.css" rel="stylesheet"><link href="../rust.svg" rel="icon" type="image/svg+xml"></head><body><header class="navbar navbar-expand-md navbar-dark rd-navbar"><nav class="container-xxl flex-wrap flex-md-nowrap" aria-label="Main navigation"><a class="navbar-brand p-0 me-2" href="../memchr/index.html" aria-label="Rust"><img src="../rust.svg" width="40" height="40" alt="Rust Logo"></a><button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#rdNavbar" aria-controls="rdNavbar" aria-expanded="false" aria-label="Toggle navigation"><i class="bi bi-list"></i></button><div class="collapse navbar-collapse" id="rdNavbar"><ul class="navbar-nav flex-row flex-wrap pt-2 py-md-0"><li class="nav-item col-6 col-md-auto"><a class="nav-link p-2 active" href="../memchr/index.html">memchr</a></li></ul><hr class="d-md-none text-white-50"><ul class="navbar-nav flex-row flex-wrap ms-md-auto"><li class="nav-item col-6 col-md-auto"><a class="nav-link p-2" href="#themes" title="Toggle themes" onclick="darkmode.toggleDarkMode()"><i class="bi bi-palette"></i><small class="d-md-none ms-2">Themes</small></a></li><li class="nav-item col-6 col-md-auto" title="Unimplemented"><a class="nav-link p-2" href="#shortcuts"><i class="bi bi-question-lg"></i><small class="d-md-none ms-2">Shortcut</small></a></li><li class="nav-item col-6 col-md-auto" title="Unimplemented"><a class="nav-link p-2" href="#options"><i class="bi bi-wrench"></i><small class="d-md-none ms-2">Options</small></a></li></ul></div></nav></header><nav class="rd-subnavbar py-2 border-bottom shadow-sm" aria-label="Secondary navigation"><div class="container-xxl d-flex align-items-md-center"><form class="rd-search position-relative" id="rd-search-form"><span class="w-100" style="position: relative; display: inline-block; direction: ltr;"><input type="search" class="form-control ds-input" id="rd-search-input" placeholder="Search in memchr..." aria-label="Search docs for..." autocomplete="off" spellcheck="false" role="combobox" aria-autocomplete="list" aria-expanded="false" aria-owns="rd-search-menu" style="position: relative; vertical-align: top;" dir="auto"><span class="ds-dropdown-menu" style="position: absolute; top: 100%; z-index: 100; display: none; left: 0px; right: 0px;" role="listbox" id="rd-search-menu"><div class="rd-search-items" id="rd-search-items"></div></span></span></form><button class="btn rd-sidebar-toggle d-md-none py-0 px-1 ms-3 order-3 collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#rd-docs-nav" aria-controls="rd-docs-nav" aria-expanded="false" aria-label="Toggle docs navigation"><i class="bi bi-arrows-expand"></i><i class="bi bi-arrows-collapse"></i></button></div></nav><div id="main" class="container-xxl"><div class="rd-main"><div class="rd-intro"><h1 id="item-title" class="rd-anchor item-title">Crate <a class="mod" href="index.html">memchr</a></h1><details id="item-documentation" class="rd-anchor item-documentation" open=""><summary>Documentation</summary><div class="mt-2"><p>This library provides heavily optimized routines for string search primitives.</p>
<h1 class="rd-anchor" id="overview"><a href="#overview">Overview</a></h1>
<p>This section gives a brief high level overview of what this crate offers.</p>
<ul>
<li>The top-level module provides routines for searching for 1, 2 or 3 bytes
in the forward or reverse direction. When searching for more than one byte,
positions are considered a match if the byte at that position matches any
of the bytes.</li>
<li>The <a href="memmem/index.html" title="`memmem`"><code>memmem</code></a> sub-module provides forward and reverse substring search
routines.</li>
</ul>
<p>In all such cases, routines operate on <code>&amp;[u8]</code> without regard to encoding. This
is exactly what you want when searching either UTF-8 or arbitrary bytes.</p>
<h1 class="rd-anchor" id="example-using-memchr"><a href="#example-using-memchr">Example: using <code>memchr</code></a></h1>
<p>This example shows how to use <code>memchr</code> to find the first occurrence of <code>z</code> in
a haystack:</p>
<pre><code class="language-rust">use memchr::memchr;

let haystack = b&quot;foo bar baz quuz&quot;;
assert_eq!(Some(10), memchr(b'z', haystack));</code></pre><h1 class="rd-anchor" id="example-matching-one-of-three-possible-bytes"><a href="#example-matching-one-of-three-possible-bytes">Example: matching one of three possible bytes</a></h1>
<p>This examples shows how to use <code>memrchr3</code> to find occurrences of <code>a</code>, <code>b</code> or
<code>c</code>, starting at the end of the haystack.</p>
<pre><code class="language-rust">use memchr::memchr3_iter;

let haystack = b&quot;xyzaxyzbxyzc&quot;;

let mut it = memchr3_iter(b'a', b'b', b'c', haystack).rev();
assert_eq!(Some(11), it.next());
assert_eq!(Some(7), it.next());
assert_eq!(Some(3), it.next());
assert_eq!(None, it.next());</code></pre><h1 class="rd-anchor" id="example-iterating-over-substring-matches"><a href="#example-iterating-over-substring-matches">Example: iterating over substring matches</a></h1>
<p>This example shows how to use the <a href="memmem/index.html" title="`memmem`"><code>memmem</code></a> sub-module to find occurrences of
a substring in a haystack.</p>
<pre><code class="language-rust">use memchr::memmem;

let haystack = b&quot;foo bar foo baz foo&quot;;

let mut it = memmem::find_iter(haystack, &quot;foo&quot;);
assert_eq!(Some(0), it.next());
assert_eq!(Some(8), it.next());
assert_eq!(Some(16), it.next());
assert_eq!(None, it.next());</code></pre><h1 class="rd-anchor" id="example-repeating-a-search-for-the-same-needle"><a href="#example-repeating-a-search-for-the-same-needle">Example: repeating a search for the same needle</a></h1>
<p>It may be possible for the overhead of constructing a substring searcher to be
measurable in some workloads. In cases where the same needle is used to search
many haystacks, it is possible to do construction once and thus to avoid it for
subsequent searches. This can be done with a <a href="memmem/struct.Finder.html" title="`memmem::Finder`"><code>memmem::Finder</code></a>:</p>
<pre><code class="language-rust">use memchr::memmem;

let finder = memmem::Finder::new(&quot;foo&quot;);

assert_eq!(Some(4), finder.find(b&quot;baz foo quux&quot;));
assert_eq!(None, finder.find(b&quot;quux baz bar&quot;));</code></pre><h1 class="rd-anchor" id="why-use-this-crate"><a href="#why-use-this-crate">Why use this crate?</a></h1>
<p>At first glance, the APIs provided by this crate might seem weird. Why provide
a dedicated routine like <code>memchr</code> for something that could be implemented
clearly and trivially in one line:</p>
<pre><code class="language-rust">fn memchr(needle: u8, haystack: &amp;[u8]) -&gt; Option&lt;usize&gt; {
    haystack.iter().position(|&amp;b| b == needle)
}</code></pre>
<p>Or similarly, why does this crate provide substring search routines when Rust’s
core library already provides them?</p>
<pre><code class="language-rust">fn search(haystack: &amp;str, needle: &amp;str) -&gt; Option&lt;usize&gt; {
    haystack.find(needle)
}</code></pre>
<p>The primary reason for both of them to exist is performance. When it comes to
performance, at a high level at least, there are two primary ways to look at
it:</p>
<ul>
<li><strong>Throughput</strong>: For this, think about it as, “given some very large haystack
and a byte that never occurs in that haystack, how long does it take to
search through it and determine that it, in fact, does not occur?”</li>
<li><strong>Latency</strong>: For this, think about it as, “given a tiny haystack—just a
few bytes—how long does it take to determine if a byte is in it?”</li>
</ul>
<p>The <code>memchr</code> routine in this crate has <em>slightly</em> worse latency than the
solution presented above, however, its throughput can easily be over an
order of magnitude faster. This is a good general purpose trade off to make.
You rarely lose, but often gain big.</p>
<p><strong>NOTE:</strong> The name <code>memchr</code> comes from the corresponding routine in libc. A key
advantage of using this library is that its performance is not tied to its
quality of implementation in the libc you happen to be using, which can vary
greatly from platform to platform.</p>
<p>But what about substring search? This one is a bit more complicated. The
primary reason for its existence is still indeed performance, but it’s also
useful because Rust’s core library doesn’t actually expose any substring
search routine on arbitrary bytes. The only substring search routine that
exists works exclusively on valid UTF-8.</p>
<p>So if you have valid UTF-8, is there a reason to use this over the standard
library substring search routine? Yes. This routine is faster on almost every
metric, including latency. The natural question then, is why isn’t this
implementation in the standard library, even if only for searching on UTF-8?
The reason is that the implementation details for using SIMD in the standard
library haven’t quite been worked out yet.</p>
<p><strong>NOTE:</strong> Currently, only <code>x86_64</code> targets have highly accelerated
implementations of substring search. For <code>memchr</code>, all targets have
somewhat-accelerated implementations, while only <code>x86_64</code> targets have highly
accelerated implementations. This limitation is expected to be lifted once the
standard library exposes a platform independent SIMD API.</p>
<h1 class="rd-anchor" id="crate-features"><a href="#crate-features">Crate features</a></h1>
<ul>
<li><strong>std</strong> - When enabled (the default), this will permit this crate to use
features specific to the standard library. Currently, the only thing used
from the standard library is runtime SIMD CPU feature detection. This means
that this feature must be enabled to get AVX accelerated routines. When
<code>std</code> is not enabled, this crate will still attempt to use SSE2 accelerated
routines on <code>x86_64</code>.</li>
<li><strong>libc</strong> - When enabled (<strong>not</strong> the default), this library will use your
platform’s libc implementation of <code>memchr</code> (and <code>memrchr</code> on Linux). This
can be useful on non-<code>x86_64</code> targets where the fallback implementation in
this crate is not as good as the one found in your libc. All other routines
(e.g., <code>memchr[23]</code> and substring search) unconditionally use the
implementation in this crate.</li>
</ul>
</div></details></div><div id="rd-docs-nav" class="rd-toc ps-xl-3 collapse"><strong class="d-block h6 my-2 pb-2 border-bottom">On this page</strong><nav id="TableOfContents"><ul><li><a href="#item-title" class="d-inline-flex align-items-center rounded"><strong>memchr</strong></a></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#item-documentation" data-bs-toggle="collapse" data-bs-target="#toc-documentation" aria-expanded="true" aria-current="true"><strong>Documentation</strong></a><ul id="toc-documentation" class="collapse show"><li><a href="#overview" class="d-inline-block align-items-center rounded">Overview</a></li><li><a href="#example-using-memchr" class="d-inline-block align-items-center rounded">Example: using memchr</a></li><li><a href="#example-matching-one-of-three-possible-bytes" class="d-inline-block align-items-center rounded">Example: matching one of three possible bytes</a></li><li><a href="#example-iterating-over-substring-matches" class="d-inline-block align-items-center rounded">Example: iterating over substring matches</a></li><li><a href="#example-repeating-a-search-for-the-same-needle" class="d-inline-block align-items-center rounded">Example: repeating a search for the same needle</a></li><li><a href="#why-use-this-crate" class="d-inline-block align-items-center rounded">Why use this crate?</a></li><li><a href="#crate-features" class="d-inline-block align-items-center rounded">Crate features</a></li></ul></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#modules" data-bs-toggle="collapse" data-bs-target="#toc-modules" aria-expanded="true" aria-current="true"><strong>Modules</strong></a><ul id="toc-modules" class="collapse show"><li><a href="memmem/index.html" class="d-inline-block align-items-center rounded">memmem</a></li></ul></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#structs" data-bs-toggle="collapse" data-bs-target="#toc-structs" aria-expanded="true" aria-current="true"><strong>Structs</strong></a><ul id="toc-structs" class="collapse show"><li><a href="struct.Memchr.html" class="d-inline-block align-items-center rounded">Memchr</a></li><li><a href="struct.Memchr2.html" class="d-inline-block align-items-center rounded">Memchr2</a></li><li><a href="struct.Memchr3.html" class="d-inline-block align-items-center rounded">Memchr3</a></li></ul></li><li><a class="rd-btn-toc d-inline-block align-items-center rounded bi bi-caret-right-fill" href="#functions" data-bs-toggle="collapse" data-bs-target="#toc-functions" aria-expanded="true" aria-current="true"><strong>Functions</strong></a><ul id="toc-functions" class="collapse show"><li><a href="fn.memchr.html" class="d-inline-block align-items-center rounded">memchr</a></li><li><a href="fn.memchr2.html" class="d-inline-block align-items-center rounded">memchr2</a></li><li><a href="fn.memchr2_iter.html" class="d-inline-block align-items-center rounded">memchr2_iter</a></li><li><a href="fn.memchr3.html" class="d-inline-block align-items-center rounded">memchr3</a></li><li><a href="fn.memchr3_iter.html" class="d-inline-block align-items-center rounded">memchr3_iter</a></li><li><a href="fn.memchr_iter.html" class="d-inline-block align-items-center rounded">memchr_iter</a></li><li><a href="fn.memrchr.html" class="d-inline-block align-items-center rounded">memrchr</a></li><li><a href="fn.memrchr2.html" class="d-inline-block align-items-center rounded">memrchr2</a></li><li><a href="fn.memrchr2_iter.html" class="d-inline-block align-items-center rounded">memrchr2_iter</a></li><li><a href="fn.memrchr3.html" class="d-inline-block align-items-center rounded">memrchr3</a></li><li><a href="fn.memrchr3_iter.html" class="d-inline-block align-items-center rounded">memrchr3_iter</a></li><li><a href="fn.memrchr_iter.html" class="d-inline-block align-items-center rounded">memrchr_iter</a></li></ul></li></ul></nav></div><div class="rd-content"><section><h3 id="modules" class="border-bottom rd-anchor">Modules</h3><div class="item-table"><div><p><a href="memmem/index.html" class="mod">memmem</a></p></div><div><p>This module provides forward and reverse substring search routines.</p>
</div></div></section><section><h3 id="structs" class="border-bottom rd-anchor">Structs</h3><div class="item-table"><div><p><a href="struct.Memchr.html" class="struct">Memchr</a></p></div><div><p>An iterator for <code>memchr</code>.</p>
</div><div><p><a href="struct.Memchr2.html" class="struct">Memchr2</a></p></div><div><p>An iterator for <code>memchr2</code>.</p>
</div><div><p><a href="struct.Memchr3.html" class="struct">Memchr3</a></p></div><div><p>An iterator for <code>memchr3</code>.</p>
</div></div></section><section><h3 id="functions" class="border-bottom rd-anchor">Functions</h3><div class="item-table"><div><p><a href="fn.memchr.html" class="fn">memchr</a></p></div><div><p>Search for the first occurrence of a byte in a slice.</p>
</div><div><p><a href="fn.memchr2.html" class="fn">memchr2</a></p></div><div><p>Like <code>memchr</code>, but searches for either of two bytes instead of just one.</p>
</div><div><p><a href="fn.memchr2_iter.html" class="fn">memchr2_iter</a></p></div><div><p>An iterator over all occurrences of the needles in a haystack.</p>
</div><div><p><a href="fn.memchr3.html" class="fn">memchr3</a></p></div><div><p>Like <code>memchr</code>, but searches for any of three bytes instead of just one.</p>
</div><div><p><a href="fn.memchr3_iter.html" class="fn">memchr3_iter</a></p></div><div><p>An iterator over all occurrences of the needles in a haystack.</p>
</div><div><p><a href="fn.memchr_iter.html" class="fn">memchr_iter</a></p></div><div><p>An iterator over all occurrences of the needle in a haystack.</p>
</div><div><p><a href="fn.memrchr.html" class="fn">memrchr</a></p></div><div><p>Search for the last occurrence of a byte in a slice.</p>
</div><div><p><a href="fn.memrchr2.html" class="fn">memrchr2</a></p></div><div><p>Like <code>memrchr</code>, but searches for either of two bytes instead of just one.</p>
</div><div><p><a href="fn.memrchr2_iter.html" class="fn">memrchr2_iter</a></p></div><div><p>An iterator over all occurrences of the needles in a haystack, in reverse.</p>
</div><div><p><a href="fn.memrchr3.html" class="fn">memrchr3</a></p></div><div><p>Like <code>memrchr</code>, but searches for any of three bytes instead of just one.</p>
</div><div><p><a href="fn.memrchr3_iter.html" class="fn">memrchr3_iter</a></p></div><div><p>An iterator over all occurrences of the needles in a haystack, in reverse.</p>
</div><div><p><a href="fn.memrchr_iter.html" class="fn">memrchr_iter</a></p></div><div><p>An iterator over all occurrences of the needle in a haystack, in reverse.</p>
</div></div></section></div></div></div><footer class="container-xxl text-center">The rd developpers - (c) 2022</footer><script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.min.js" integrity="sha384-cn7l7gDp0eyniUwwAZgrzD06kc/tftFf19TOAs2zVinnD/C7E91j9yyk5//jjpt/" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/js/darkmode.min.js" integrity="sha384-A4SLs39X/aUfwRclRaXvNeXNBTLZdnZdHhhteqbYFS2jZTRD79tKeFeBn7SGXNpi" crossorigin="anonymous"></script><script src="../memchr/search-index.js"></script><script src="../search.js"></script></body></html>
